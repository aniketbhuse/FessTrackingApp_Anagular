<div class="min-h-screen flex flex-col bg-gray-50">

  <!-- ================= HEADER ================= -->
  <div class="bg-gradient-to-r from-purple-600 p-6 flex flex-col md:flex-row justify-between items-center gap-4">

    <div class="text-left">
      <h1 class="text-3xl font-bold text-white">Enrollment Management</h1>
      <p class="text-purple-200 mt-1">Manage and organize enrollments efficiently</p>
    </div>

    <div class="flex flex-wrap gap-2 items-center">

      <!-- Search -->
      <input type="text" placeholder="Search Enrollment..." [(ngModel)]="searchText" (input)="onSearch()"
        class="px-3 py-2 rounded  w-64" />

      <!-- View Toggle -->
     <div class="flex border rounded overflow-hidden">
        <button class="flex items-center justify-center p-2 rounded-lg transition-colors duration-200
           hover:bg-blue-100 focus:outline-none" [class.bg-blue-600]="viewMode==='card'"
          [class.text-white]="viewMode==='card'" [class.text-gray-700]="viewMode!=='card'" (click)="toggleView('card')">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20">
            <path
              d="M5 3a2 2 0 00-2 2v3h4V3H5zM13 3h-4v5h4V3zM3 12v3a2 2 0 002 2h3v-5H3zM12 12v5h3a2 2 0 002-2v-3h-5z" />
          </svg>
        </button>

        <!-- Table View Button -->
        <button class="flex items-center justify-center p-2 rounded-lg transition-colors duration-200
           hover:bg-blue-100 focus:outline-none" [class.bg-blue-600]="viewMode==='table'"
          [class.text-white]="viewMode==='table'" [class.text-gray-700]="viewMode!=='table'"
          (click)="toggleView('table')">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20">
            <path d="M3 3h14v2H3V3zm0 4h14v2H3V7zm0 4h14v2H3v-2zm0 4h14v2H3v-2z" />
          </svg>
        </button>
      </div>

      <!-- Create -->
      <button
        class="flex items-center gap-2 px-4 py-2 border-2 border-blue-600 text-blue-600 rounded shadow hover:bg-blue-50 hover:text-blue-700 transition"
        (click)="openModal()">
        <!-- SVG Icon: Plus inside a circle -->
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"
          stroke-width="2">
          <circle cx="12" cy="12" r="10" />
          <line x1="12" y1="8" x2="12" y2="16" />
          <line x1="8" y1="12" x2="16" y2="12" />
        </svg> Create Enrollment
      </button>

    </div>
  </div>

  <!-- ================= CONTENT ================= -->
  <div class="flex-1 p-6">

    <!-- ========== TABLE VIEW ========== -->
    <div *ngIf="viewMode === 'table'" class="bg-white rounded-xl shadow-lg overflow-x-auto">

      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white">
          <tr>
            <th class="px-6 py-3 text-left">Enrollment ID</th>
            <th class="px-6 py-3 text-left">Batch ID</th>
            <th class="px-6 py-3 text-left">Candidate ID</th>
            <th class="px-6 py-3 text-left">Enrollment Date</th>
            <th class="px-6 py-3 text-left">Status</th>
            <th class="px-6 py-3 text-center">Action</th>
          </tr>
        </thead>

        <tbody class="divide-y">
          <tr *ngFor="let e of filteredEnrollmentsList | slice:(page-1)*pageSize:page*pageSize"
            class="hover:bg-blue-50">
            <td class="px-6 py-3">{{ e.enrollmentId }}</td>
            <td class="px-6 py-3">{{ e.batchId }}</td>
            <td class="px-6 py-3">{{ e.candidateId }}</td>
            <td class="px-6 py-3">{{ e.enrollmentDate | date:'shortDate' }}</td>

            <td class="px-6 py-3">
              <span [ngClass]="e.isActive ? 'text-green-600' : 'text-red-500'">
                {{ e.isActive ? 'Active' : 'Inactive' }}
              </span>
            </td>

            <td class="px-6 py-3 text-center">
              <button (click)="delete(e.enrollmentId)" class="text-red-600">ðŸ—‘</button>
            </td>

          </tr>
        </tbody>
      </table>
    </div>

    <!-- ========== CARD VIEW ========== -->
    <div *ngIf="viewMode === 'card'" class="grid grid-cols-1 md:grid-cols-2 gap-6">

      <div *ngFor="let e of filteredEnrollmentsList" class="bg-white rounded-2xl border shadow p-6 relative">

        <h3 class="text-xl font-bold text-blue-600">
          Enrollment #{{ e.enrollmentId }}
        </h3>

        <div class="mt-3 text-gray-600 space-y-1">
          <p><b>Batch ID:</b> {{ e.batchId }}</p>
          <p><b>Candidate ID:</b> {{ e.candidateId }}</p>
          <p><b>Date:</b> {{ e.enrollmentDate | date:'MMM d, y' }}</p>
        </div>

        <span class="absolute bottom-4 right-4 px-3 py-1 rounded-full text-sm"
          [ngClass]="e.isActive ? 'bg-green-100 text-green-700' : 'bg-gray-200 text-gray-600'">
          {{ e.isActive ? 'Active' : 'Inactive' }}
        </span>

        <button (click)="delete(e.enrollmentId)" class="absolute top-4 right-4 text-red-600">ðŸ—‘</button>

      </div>
    </div>

    <!-- ========== PAGINATION ========== -->
    <div *ngIf="enrollmentsList.length > pageSize" class="mt-6 flex justify-center">
      <button class="px-3 py-1 border" [disabled]="page === 1" (click)="page = page - 1">Prev</button>
      <span class="px-4 py-1">{{ page }}</span>
      <button class="px-3 py-1 border" [disabled]="page >= enrollmentsList.length / pageSize"
        (click)="page = page + 1">Next</button>
    </div>

  </div>

  <!-- ================= MODAL ================= -->
  <div *ngIf="isModalOpen" class="fixed inset-0 bg-black/60 flex items-center justify-center z-50">

    <div class="bg-white rounded-2xl w-full max-w-lg shadow-xl">

      <div
        class="flex items-center justify-between bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-4 py-3 sm:px-6 sm:py-4 rounded-t-2xl relative">
        <h2 class="text-base sm:text-lg font-semibold relative overflow-hidden">
          <span class="inline-block fade-slide">
            <svg xmlns="http://www.w3.org/2000/svg" class="inline h-5 w-5 mr-1 text-white" fill="none"
              viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3" />
            </svg>
            Create Enrollment
          </span>
        </h2>
        <button class="text-xl font-bold hover:rotate-90 transition-transform duration-300" (click)="closeModal()">
          &times;
        </button>
      </div>

      <div class="px-4 py-5 sm:px-6 sm:py-6 space-y-4">

        <!-- Select Batch -->
        <div class="mb-4 hover:shadow-lg hover:bg-gray-50 transition p-2 rounded-lg">
          <label class="block text-sm font-medium text-gray-700 mb-1">Select Batch</label>
          <select [(ngModel)]="newEnrollmentObj.batchId" name="batchId" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
            <option value="" disabled selected>Select Batch</option>
            @for (item of batchData(); track $index){
              <option [value]="item.batchId">{{item.batchName}}</option>
            }
          </select>
        </div>

        <!-- Select Candidate -->
        <div class="mb-4 hover:shadow-lg hover:bg-gray-50 transition p-2 rounded-lg">
          <label class="block text-sm font-medium text-gray-700 mb-1">
            Select Candidate
          </label>

          <select [(ngModel)]="newEnrollmentObj.candidateId" name="candidateId"
            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
            <option value="" disabled selected>Select Candidate</option>
            @for (item of studentList$|async; track $index){
              <option [value]="item.candidateId">{{item.fullName}}</option>
            }

          </select>
        </div>

        <!-- Enrollment Date -->
        <label class="block text-sm font-medium text-gray-700 mb-1">
          Enrollment Date
        </label>

        <div class="mb-4 hover:shadow-lg hover:bg-gray-50 transition p-2 rounded-lg flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-500" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M8 7V3m8 4V3M3 11h18M5 19h14a2 2 0 002-2V7H3v10a2 2 0 002 2z" />
          </svg>

          <input type="date" [(ngModel)]="newEnrollmentObj.enrollmentDate" name="enrollmentDate"
            class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition" />
        </div>

        <!-- Active -->
        <label class="flex items-center gap-2">
          <input type="checkbox" [(ngModel)]="newEnrollmentObj.isActive" />
          Active
        </label>

        <!-- Save -->
        <button (click)="submitEnrollment()" class="w-full border-2 border-green-600 text-green-600 py-2 rounded">
          Save
        </button>

      </div>
    </div>
  </div>


</div>